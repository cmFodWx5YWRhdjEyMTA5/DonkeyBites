<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/locale/es-us.js"></script>

<canvas id="myLineChart" width="740" height="200"></canvas>

<script>
  function drawLineChart() {

    // Add a helper to format timestamp data
    Date.prototype.formatMMDDYYYY = function() {
        return (this.getMonth() + 1) +
        "/" +  this.getDate() +
        "/" +  this.getFullYear();
    }

    var jsonData = $.ajax({
      url: 'http://142.93.111.71/DORON/DORON_followers.json',
      dataType: 'json',
    }).done(function (results) {

      // Split timestamp and data into separate arrays
      let labels = [];
      let dataFollowers={
          label: "followers",
          fillColor             : "rgba(151,187,205,0.2)",
          strokeColor           : "rgba(151,187,205,1)",
          pointColor            : "rgba(151,187,205,1)",
          pointStrokeColor      : "#fff",
          pointHighlightFill    : "#fff",
          pointHighlightStroke  : "rgba(151,187,205,1)",
          data: []
      };
      let dataFollowing={
        label: "following",
        fillColor             : "rgba(151,187,205,0.2)",
        strokeColor           : "rgba(151,187,205,1)",
        pointColor            : "rgba(151,187,205,1)",
        pointStrokeColor      : "#fff",
        pointHighlightFill    : "#fff",
        pointHighlightStroke  : "rgba(151,187,205,1)",
        data: []
      };   

      results.data.entries.forEach(function(packet) {
        labels.push(moment.unix(packet.Date).format('MM/DD/YYYY'));
        dataFollowers.data.push(parseFloat(packet.Followers));
        dataFollowing.data.push(parseFloat(packet.Following));
      });

      // Create the chart.js data structure using 'labels' and 'data'
      var tempData = {
        labels : labels,
        datasets : [dataFollowers,dataFollowing]
      }

      // Get the context of the canvas element we want to select
      var ctx = document.getElementById("myLineChart").getContext("2d");

      var options ={}

      console.log(tempData);

      var myLineChart = new Chart(ctx, {
          type: 'line',
          data: tempData,
          options: options
      });

    });
  }

  drawLineChart();
</script>
